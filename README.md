# multipole-decomposition-of-dielectric-nanoparticles-in-a-hexagonal-array
These files of COMSOL and MATLAB make the calculation of the electromagnetic fields for a hexagonal array of Silicon hemispheres over a dielectric (mesoporous titania) array of cylinders with the same arrangement over a base layer of the dielectric on top a silica substrate. The multipole decomposition of the particles is made and the surface energy and reflectance are calculated.  If you use this files, please, cite as Molet, P., Gil-Herrera, L., Garcia-Pomar, J., Caselli, N., Blanco, Á., López, C., &amp; Mihi, A. (2020). Large area metasurfaces made with spherical silicon resonators, Nanophotonics, 9(4), 943-951. doi: https://doi.org/10.1515/nanoph-2020-0035  

Steps

0.Download the files from https://zenodo.org/record/4009029#.X00FljXtZhE (exceed the limit here)
1. Create a folder called C:\datacomsol\ 
2. Change the geometric and materials parameters if you want. 
3. Run the COMSOL files (v.5.5) (_RF for Radiofrequency module or _WO for Wave optics module). 
4. Clear all the tables in Tables. 
5. Evaluate all the derived values. 
6. Export all the data in Export. 
7. run Matlab file (v.2010b).
